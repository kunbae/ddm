# í”„ë¡œì íŠ¸ êµ¬ì„± ë° ì‹¤í–‰ ë¡œì§ ì„¤ëª…

> âš ï¸ **ì—…ë°ì´íŠ¸ ì•ˆë‚´ (Supabase ì—°ë™)**
> 
> í˜„ì¬ í”„ë¡œì íŠ¸ëŠ” Supabase(PostgreSQL)ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ì „í™˜ë˜ì—ˆìŠµë‹ˆë‹¤. ì•„ë˜ ë¬¸ì„œì—ì„œ JSON ê¸°ë°˜ ì €ì¥ì†Œ(`data/*.json`)ì— ê´€í•œ ì–¸ê¸‰ì€ ì°¸ê³ ìš©ìœ¼ë¡œ ë‚¨ê²¨ì ¸ ìˆìœ¼ë‚˜, ì‹¤ì œ ë°ì´í„°ëŠ” Supabaseì— ì €ì¥ë©ë‹ˆë‹¤. ìµœì‹  ìŠ¤í‚¤ë§ˆì™€ ì„¤ì • ë°©ë²•ì€ `supabase/schema.sql` ë° `SUPABASE_SETUP.md`ë¥¼ í™•ì¸í•˜ì„¸ìš”.

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
board-website/
â”œâ”€â”€ app/                          # Next.js App Router ë””ë ‰í† ë¦¬
â”‚   â”œâ”€â”€ api/                      # API ë¼ìš°íŠ¸ (ë°±ì—”ë“œ)
â”‚   â”‚   â”œâ”€â”€ auth/                 # ì¸ì¦ ê´€ë ¨ API
â”‚   â”‚   â”‚   â”œâ”€â”€ login/route.ts    # ë¡œê·¸ì¸ API
â”‚   â”‚   â”‚   â”œâ”€â”€ logout/route.ts   # ë¡œê·¸ì•„ì›ƒ API
â”‚   â”‚   â”‚   â”œâ”€â”€ register/route.ts # íšŒì›ê°€ì… API
â”‚   â”‚   â”‚   â””â”€â”€ me/route.ts       # í˜„ì¬ ì‚¬ìš©ì ì •ë³´ API
â”‚   â”‚   â”œâ”€â”€ boards/route.ts       # ê²Œì‹œíŒ ëª©ë¡ API
â”‚   â”‚   â””â”€â”€ posts/                # ê²Œì‹œê¸€ ê´€ë ¨ API (ìŠ¹ì¸/ê²€í†  í¬í•¨)
â”‚   â”‚       â”œâ”€â”€ route.ts          # ê²Œì‹œê¸€ ëª©ë¡/ì‘ì„± API
â”‚   â”‚       â””â”€â”€ [id]/route.ts     # ê²Œì‹œê¸€ ìƒì„¸/ìˆ˜ì •/ì‚­ì œ/ìŠ¹ì¸ API
â”‚   â”œâ”€â”€ board/[id]/page.tsx       # ê²Œì‹œíŒ í˜ì´ì§€ (ë™ì  ë¼ìš°íŠ¸)
â”‚   â”œâ”€â”€ post/[id]/page.tsx        # ê²Œì‹œê¸€ ìƒì„¸ í˜ì´ì§€ (ê²€í† /ìŠ¹ì¸ UI)
â”‚   â”œâ”€â”€ login/page.tsx            # ë¡œê·¸ì¸/íšŒì›ê°€ì… í˜ì´ì§€
â”‚   â”œâ”€â”€ page.tsx                  # í™ˆ í˜ì´ì§€ (ê³µì§€ì‚¬í•­)
â”‚   â”œâ”€â”€ layout.tsx                # ë£¨íŠ¸ ë ˆì´ì•„ì›ƒ
â”‚   â””â”€â”€ globals.css               # ì „ì—­ CSS ìŠ¤íƒ€ì¼
â”œâ”€â”€ lib/                          # ê³µí†µ ë¼ì´ë¸ŒëŸ¬ë¦¬
â”‚   â”œâ”€â”€ supabase.ts               # Supabase í´ë¼ì´ì–¸íŠ¸ ë° íƒ€ì… ì •ì˜
â”‚   â”œâ”€â”€ db.ts                     # ì´ˆê¸° ë°ì´í„°/ê´€ë¦¬ì ê³„ì • ì´ˆê¸°í™” ë¡œì§
â”‚   â”œâ”€â”€ auth.ts                   # ì¸ì¦ ê´€ë ¨ í•¨ìˆ˜ (role/region í¬í•¨)
â”‚   â””â”€â”€ posts.ts                  # ê²Œì‹œê¸€/ê²€í†  ê´€ë ¨ í•¨ìˆ˜
â”œâ”€â”€ supabase/                     # ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ë° ì´ˆê¸° ë°ì´í„°
â”‚   â””â”€â”€ schema.sql
â”œâ”€â”€ SUPABASE_SETUP.md             # Supabase ì—°ë™ ì ˆì°¨ ê°€ì´ë“œ
â”œâ”€â”€ package.json                  # í”„ë¡œì íŠ¸ ì„¤ì • ë° ì˜ì¡´ì„±
â”œâ”€â”€ tsconfig.json                 # TypeScript ì„¤ì •
â”œâ”€â”€ tailwind.config.ts            # Tailwind CSS ì„¤ì •
â”œâ”€â”€ next.config.js                # Next.js ì„¤ì •
â””â”€â”€ postcss.config.js             # PostCSS ì„¤ì •
```

## ğŸš€ ì‹¤í–‰ ìˆœì„œ ë° ë¡œì§

### 1. ì„œë²„ ì‹œì‘ (`npm run dev`)

**ì‹¤í–‰ íŒŒì¼**: `package.json` â†’ `scripts.dev: "next dev"`

1. **Next.js ì„œë²„ ì‹œì‘**
   - Next.jsê°€ `app/` ë””ë ‰í† ë¦¬ë¥¼ ìŠ¤ìº”í•˜ì—¬ ë¼ìš°íŠ¸ êµ¬ì¡° ìƒì„±
   - TypeScript ì»´íŒŒì¼ ì‹œì‘
   - ê°œë°œ ì„œë²„ê°€ `http://localhost:3000`ì—ì„œ ì‹œì‘

### 2. ì´ˆê¸°í™” ë‹¨ê³„

#### 2.1 ë ˆì´ì•„ì›ƒ ë¡œë“œ
**íŒŒì¼**: `app/layout.tsx`
- ë£¨íŠ¸ ë ˆì´ì•„ì›ƒì´ ë¨¼ì € ë¡œë“œë¨
- HTML ê¸°ë³¸ êµ¬ì¡°ì™€ ë©”íƒ€ë°ì´í„° ì„¤ì •
- ëª¨ë“  í˜ì´ì§€ì— ê³µí†µìœ¼ë¡œ ì ìš©ë˜ëŠ” êµ¬ì¡°

#### 2.2 ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™” (ì²« API í˜¸ì¶œ ì‹œ)
**íŒŒì¼**: `lib/db.ts` â†’ `initDatabase()`

**ì‹¤í–‰ ìˆœì„œ**:
1. `data/` ë””ë ‰í† ë¦¬ ìƒì„± (ì—†ìœ¼ë©´)
2. ê²Œì‹œíŒ ë°ì´í„° í™•ì¸ (`data/boards.json`)
   - ì—†ìœ¼ë©´ ê¸°ë³¸ 10ê°œ ê²Œì‹œíŒ ìƒì„±
3. ì‚¬ìš©ì ë°ì´í„° í™•ì¸ (`data/users.json`)
   - ì—†ìœ¼ë©´ ê¸°ë³¸ ê´€ë¦¬ì ê³„ì • ìƒì„±
   - ì‚¬ìš©ìëª…: `admin`, ë¹„ë°€ë²ˆí˜¸: `admin123`
4. ê²Œì‹œê¸€ ë°ì´í„° íŒŒì¼ ì´ˆê¸°í™” (`data/posts.json`)

**í˜¸ì¶œ ì‹œì **: 
- ì²« ë²ˆì§¸ API ìš”ì²­ ì‹œ (ì˜ˆ: `/api/boards`, `/api/auth/login` ë“±)
- ê° API ë¼ìš°íŠ¸ì—ì„œ `await initDatabase()` í˜¸ì¶œ

### 3. í˜ì´ì§€ ì ‘ê·¼ íë¦„

#### 3.1 í™ˆ í˜ì´ì§€ ì ‘ê·¼ (`/`)
**íŒŒì¼**: `app/page.tsx`

**ì‹¤í–‰ ìˆœì„œ**:
1. ì»´í¬ë„ŒíŠ¸ ë§ˆìš´íŠ¸ â†’ `useEffect` ì‹¤í–‰
2. `loadData()` í•¨ìˆ˜ í˜¸ì¶œ:
   ```
   - GET /api/boards â†’ ê²Œì‹œíŒ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
   - GET /api/posts?notices=true â†’ ê³µì§€ì‚¬í•­ ê°€ì ¸ì˜¤ê¸°
   - GET /api/auth/me â†’ í˜„ì¬ ë¡œê·¸ì¸ ì‚¬ìš©ì í™•ì¸
   ```
3. API ì‘ë‹µ ë°›ì•„ì„œ ìƒíƒœ ì—…ë°ì´íŠ¸
4. í™”ë©´ ë Œë”ë§:
   - ì¢Œì¸¡ ì‚¬ì´ë“œë°”: ê²Œì‹œíŒ ëª©ë¡
   - ë©”ì¸ ì˜ì—­: ê³µì§€ì‚¬í•­ ëª©ë¡
   - í—¤ë”: ë¡œê·¸ì¸ ìƒíƒœ í‘œì‹œ

#### 3.2 ë¡œê·¸ì¸ í˜ì´ì§€ ì ‘ê·¼ (`/login`)
**íŒŒì¼**: `app/login/page.tsx`

**ì‹¤í–‰ ìˆœì„œ**:
1. ë¡œê·¸ì¸/íšŒì›ê°€ì… í¼ í‘œì‹œ
2. ì‚¬ìš©ìê°€ ì œì¶œ ì‹œ:
   - **íšŒì›ê°€ì…**: `POST /api/auth/register`
     - `lib/auth.ts` â†’ `registerUser()` í˜¸ì¶œ
     - ë¹„ë°€ë²ˆí˜¸ í•´ì‹œí™” (bcrypt)
     - `data/users.json`ì— ì €ì¥
   - **ë¡œê·¸ì¸**: `POST /api/auth/login`
     - `lib/auth.ts` â†’ `loginUser()` í˜¸ì¶œ
     - ë¹„ë°€ë²ˆí˜¸ ê²€ì¦
     - JWT í† í° ìƒì„±
     - ì¿ í‚¤ì— í† í° ì €ì¥
     - í™ˆ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸

#### 3.3 ê²Œì‹œíŒ í˜ì´ì§€ ì ‘ê·¼ (`/board/[id]`)
**íŒŒì¼**: `app/board/[id]/page.tsx`

**ì‹¤í–‰ ìˆœì„œ**:
1. URLì—ì„œ ê²Œì‹œíŒ ID ì¶”ì¶œ (`[id]`)
2. `loadData()` í•¨ìˆ˜ í˜¸ì¶œ:
   ```
   - GET /api/boards â†’ ê²Œì‹œíŒ ëª©ë¡
   - GET /api/posts?boardId={id} â†’ í•´ë‹¹ ê²Œì‹œíŒì˜ ê²Œì‹œê¸€ ëª©ë¡
   - GET /api/auth/me â†’ í˜„ì¬ ì‚¬ìš©ì í™•ì¸
   ```
3. í™”ë©´ ë Œë”ë§:
   - ì¢Œì¸¡ ì‚¬ì´ë“œë°”: ê²Œì‹œíŒ ëª©ë¡ (í˜„ì¬ ê²Œì‹œíŒ í•˜ì´ë¼ì´íŠ¸)
   - ë©”ì¸ ì˜ì—­: ê²Œì‹œê¸€ ëª©ë¡
   - ê¸€ì“°ê¸° ë²„íŠ¼ (ë¡œê·¸ì¸ ì‹œ)

#### 3.4 ê²Œì‹œê¸€ ìƒì„¸ í˜ì´ì§€ (`/post/[id]`)
**íŒŒì¼**: `app/post/[id]/page.tsx`

**ì‹¤í–‰ ìˆœì„œ**:
1. URLì—ì„œ ê²Œì‹œê¸€ ID ì¶”ì¶œ
2. `loadData()` í•¨ìˆ˜ í˜¸ì¶œ:
   ```
   - GET /api/boards â†’ ê²Œì‹œíŒ ëª©ë¡
   - GET /api/posts/{id} â†’ ê²Œì‹œê¸€ ìƒì„¸ ì •ë³´
   - GET /api/auth/me â†’ í˜„ì¬ ì‚¬ìš©ì í™•ì¸
   ```
3. ì¡°íšŒìˆ˜ ì¦ê°€ (`lib/posts.ts` â†’ `incrementViews()`)
4. í™”ë©´ ë Œë”ë§:
   - ê²Œì‹œê¸€ ë‚´ìš© í‘œì‹œ
   - ìˆ˜ì •/ì‚­ì œ ë²„íŠ¼ (ì‘ì„±ìë§Œ)

### 4. API ë¼ìš°íŠ¸ ì‹¤í–‰ íë¦„

#### 4.1 ì¸ì¦ API

**`/api/auth/register`** (`app/api/auth/register/route.ts`)
```
1. initDatabase() í˜¸ì¶œ â†’ ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™” í™•ì¸
2. ìš”ì²­ ë³¸ë¬¸ íŒŒì‹± (username, password, email)
3. lib/auth.ts â†’ registerUser() í˜¸ì¶œ
   - ì¤‘ë³µ ì‚¬ìš©ì í™•ì¸
   - ë¹„ë°€ë²ˆí˜¸ í•´ì‹œí™”
   - users.jsonì— ì €ì¥
4. ìƒˆ ì‚¬ìš©ì ì •ë³´ ë°˜í™˜
```

**`/api/auth/login`** (`app/api/auth/login/route.ts`)
```
1. initDatabase() í˜¸ì¶œ
2. ìš”ì²­ ë³¸ë¬¸ íŒŒì‹± (username, password)
3. lib/auth.ts â†’ loginUser() í˜¸ì¶œ
   - ì‚¬ìš©ì ì°¾ê¸°
   - ë¹„ë°€ë²ˆí˜¸ ê²€ì¦
   - JWT í† í° ìƒì„±
4. ì¿ í‚¤ì— í† í° ì €ì¥ í›„ ì‚¬ìš©ì ì •ë³´ ë°˜í™˜
```

**`/api/auth/me`** (`app/api/auth/me/route.ts`)
```
1. ì¿ í‚¤ì—ì„œ í† í° ì¶”ì¶œ
2. lib/auth.ts â†’ verifyToken() í˜¸ì¶œ
3. í† í° ê²€ì¦ í›„ ì‚¬ìš©ì ì •ë³´ ë°˜í™˜
```

#### 4.2 ê²Œì‹œíŒ API

**`/api/boards`** (`app/api/boards/route.ts`)
```
1. initDatabase() í˜¸ì¶œ
2. lib/posts.ts â†’ getAllBoards() í˜¸ì¶œ
   - data/boards.json ì½ê¸°
   - order_indexë¡œ ì •ë ¬
3. ê²Œì‹œíŒ ëª©ë¡ ë°˜í™˜
```

#### 4.3 ê²Œì‹œê¸€ API

**`GET /api/posts`** (`app/api/posts/route.ts`)
```
- ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° í™•ì¸:
  - notices=true â†’ ê³µì§€ì‚¬í•­ë§Œ ë°˜í™˜
  - boardId={id} â†’ í•´ë‹¹ ê²Œì‹œíŒì˜ ê²Œì‹œê¸€ ë°˜í™˜
- lib/posts.ts â†’ getPostsByBoard() ë˜ëŠ” getAllNotices() í˜¸ì¶œ
- ê²Œì‹œê¸€ ëª©ë¡ ë°˜í™˜
```

**`POST /api/posts`** (`app/api/posts/route.ts`)
```
1. ì¿ í‚¤ì—ì„œ í† í° í™•ì¸
2. í† í° ê²€ì¦
3. ìš”ì²­ ë³¸ë¬¸ íŒŒì‹± (boardId, title, content, isNotice)
4. lib/posts.ts â†’ createPost() í˜¸ì¶œ
   - ìƒˆ ê²Œì‹œê¸€ ìƒì„±
   - data/posts.jsonì— ì €ì¥
5. ê²Œì‹œê¸€ ID ë°˜í™˜
```

**`GET /api/posts/[id]`** (`app/api/posts/[id]/route.ts`)
```
1. URLì—ì„œ ê²Œì‹œê¸€ ID ì¶”ì¶œ
2. lib/posts.ts â†’ getPostById() í˜¸ì¶œ
3. ì¡°íšŒìˆ˜ ì¦ê°€ (incrementViews())
4. ê²Œì‹œê¸€ ì •ë³´ ë°˜í™˜
```

**`PUT /api/posts/[id]`** (`app/api/posts/[id]/route.ts`)
```
1. í† í° í™•ì¸ ë° ê²€ì¦
2. URLì—ì„œ ê²Œì‹œê¸€ ID ì¶”ì¶œ
3. ìš”ì²­ ë³¸ë¬¸ íŒŒì‹± (title, content, isNotice)
4. lib/posts.ts â†’ updatePost() í˜¸ì¶œ
   - ì‘ì„±ì í™•ì¸ (user_id ì¼ì¹˜)
   - ê²Œì‹œê¸€ ìˆ˜ì •
5. ì„±ê³µ ì—¬ë¶€ ë°˜í™˜
```

**`DELETE /api/posts/[id]`** (`app/api/posts/[id]/route.ts`)
```
1. í† í° í™•ì¸ ë° ê²€ì¦
2. URLì—ì„œ ê²Œì‹œê¸€ ID ì¶”ì¶œ
3. lib/posts.ts â†’ deletePost() í˜¸ì¶œ
   - ì‘ì„±ì í™•ì¸
   - ê²Œì‹œê¸€ ì‚­ì œ
4. ì„±ê³µ ì—¬ë¶€ ë°˜í™˜
```

## ğŸ“Š ë°ì´í„° íë¦„

### ë°ì´í„° ì €ì¥ êµ¬ì¡°

**`data/users.json`**
```json
[
  {
    "id": 1,
    "username": "admin",
    "password": "$2a$10$...",  // í•´ì‹œëœ ë¹„ë°€ë²ˆí˜¸
    "email": "admin@example.com",
    "created_at": "2024-01-01T00:00:00.000Z"
  }
]
```

**`data/boards.json`**
```json
[
  {
    "id": 1,
    "name": "ê³µì§€ì‚¬í•­",
    "description": "ì „ì²´ ê³µì§€ì‚¬í•­",
    "order_index": 0,
    "created_at": "2024-01-01T00:00:00.000Z"
  }
]
```

**`data/posts.json`**
```json
[
  {
    "id": 1,
    "board_id": 1,
    "user_id": 1,
    "title": "ì œëª©",
    "content": "ë‚´ìš©",
    "is_notice": 1,
    "views": 0,
    "created_at": "2024-01-01T00:00:00.000Z",
    "updated_at": "2024-01-01T00:00:00.000Z"
  }
]
```

## ğŸ”„ ì£¼ìš” í•¨ìˆ˜ í˜¸ì¶œ ì²´ì¸

### ê¸€ ì‘ì„± ì‹œ
```
ì‚¬ìš©ì ì…ë ¥ â†’ page.tsx (handleWrite)
  â†’ POST /api/posts
    â†’ initDatabase() (ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™” í™•ì¸)
    â†’ lib/posts.ts (createPost)
      â†’ lib/db.ts (getDatabase)
        â†’ data/posts.jsonì— ì €ì¥
```

### ë¡œê·¸ì¸ ì‹œ
```
ì‚¬ìš©ì ì…ë ¥ â†’ login/page.tsx
  â†’ POST /api/auth/login
    â†’ initDatabase() (ê´€ë¦¬ì ê³„ì • ìƒì„± í™•ì¸)
    â†’ lib/auth.ts (loginUser)
      â†’ ë¹„ë°€ë²ˆí˜¸ ê²€ì¦
      â†’ JWT í† í° ìƒì„±
      â†’ ì¿ í‚¤ì— ì €ì¥
```

### ê²Œì‹œê¸€ ì¡°íšŒ ì‹œ
```
í˜ì´ì§€ ì ‘ê·¼ â†’ page.tsx (loadData)
  â†’ GET /api/posts?boardId={id}
    â†’ lib/posts.ts (getPostsByBoard)
      â†’ data/posts.json ì½ê¸°
      â†’ ì‚¬ìš©ì/ê²Œì‹œíŒ ì •ë³´ ì¡°ì¸
      â†’ ì •ë ¬ í›„ ë°˜í™˜
```

## ğŸ¯ í•µì‹¬ íŒŒì¼ ì—­í• 

1. **`lib/db.ts`**: ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™” ë° íŒŒì¼ I/O ê´€ë¦¬
2. **`lib/auth.ts`**: ì‚¬ìš©ì ì¸ì¦, ë¹„ë°€ë²ˆí˜¸ í•´ì‹œí™”, JWT í† í° ê´€ë¦¬
3. **`lib/posts.ts`**: ê²Œì‹œíŒ ë° ê²Œì‹œê¸€ CRUD ë¡œì§
4. **`app/api/**/route.ts`**: RESTful API ì—”ë“œí¬ì¸íŠ¸
5. **`app/**/page.tsx`**: í˜ì´ì§€ ì»´í¬ë„ŒíŠ¸ (í”„ë¡ íŠ¸ì—”ë“œ)

## âš™ï¸ ì„¤ì • íŒŒì¼

- **`package.json`**: í”„ë¡œì íŠ¸ ë©”íƒ€ë°ì´í„°, ì˜ì¡´ì„±, ìŠ¤í¬ë¦½íŠ¸
- **`tsconfig.json`**: TypeScript ì»´íŒŒì¼ ì˜µì…˜
- **`tailwind.config.ts`**: Tailwind CSS ì„¤ì •
- **`next.config.js`**: Next.js ë¹Œë“œ ì„¤ì •

## ğŸ” ë³´ì•ˆ

- ë¹„ë°€ë²ˆí˜¸: bcryptjsë¡œ í•´ì‹œí™”í•˜ì—¬ ì €ì¥
- ì¸ì¦: JWT í† í°ì„ HTTP-only ì¿ í‚¤ì— ì €ì¥
- ê¶Œí•œ: ê²Œì‹œê¸€ ìˆ˜ì •/ì‚­ì œëŠ” ì‘ì„±ìë§Œ ê°€ëŠ¥ (user_id í™•ì¸)

